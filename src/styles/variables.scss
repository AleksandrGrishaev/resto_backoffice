// src/styles/variables.scss
@use 'sass:map';

// =============================================
// –¶–í–ï–¢–û–í–ê–Ø –°–•–ï–ú–ê (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è)
// =============================================
$color: (
  'primary': #a395e9,
  'secondary': #bfb5f2,
  'background': #141416,
  'surface': #1a1a1e,
  'error': #ff9676,
  'success': #92c9af,
  'warning': #ffb076,
  'info': #76b0ff
) !default;

$black: (
  'primary': #141416,
  'surface': #1a1a1e
) !default;

// =============================================
// üÜï POS –†–ê–ó–ú–ï–†–ù–ê–Ø –°–ò–°–¢–ï–ú–ê
// =============================================

// –û—Ç—Å—Ç—É–ø—ã –∏ —Ä–∞–∑–º–µ—Ä—ã (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å clamp)
$spacing: (
  'xs': clamp(4px, 0.5vw, 8px),
  'sm': clamp(8px, 1vw, 12px),
  'md': clamp(12px, 1.5vw, 16px),
  'lg': clamp(16px, 2vw, 24px),
  'xl': clamp(24px, 3vw, 32px)
) !default;

// –†–∞–∑–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–∞ (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ)
$font-size: (
  'xs': clamp(10px, 1vw, 12px),
  'sm': clamp(12px, 1.2vw, 14px),
  'base': clamp(14px, 1.4vw, 16px),
  'lg': clamp(16px, 1.6vw, 18px),
  'xl': clamp(18px, 2vw, 22px),
  '2xl': clamp(22px, 2.5vw, 28px),
  '3xl': clamp(28px, 3vw, 36px)
) !default;

// Touch-friendly –º–∏–Ω–∏–º—É–º—ã
$touch: (
  'min': 44px,
  // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π touch target
  'button': 48px,
  // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∫–Ω–æ–ø–æ–∫
  'card': 64px,
  // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
  'input': 56px // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ inputs
) !default;

// POS Layout —Ä–∞–∑–º–µ—Ä—ã
$pos-layout: (
  'sidebar-width': max(8vw, 80px),
  // –®–∏—Ä–∏–Ω–∞ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏
  'sidebar-max-width': 200px,
  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ sidebar
  'menu-flex': 62%,
  // –ü—Ä–æ—Ü–µ–Ω—Ç —à–∏—Ä–∏–Ω—ã –º–µ–Ω—é
  'order-flex': 38%,
  // –ü—Ä–æ—Ü–µ–Ω—Ç —à–∏—Ä–∏–Ω—ã –∑–∞–∫–∞–∑–æ–≤
  'header-height': 60px,
  // –í—ã—Å–æ—Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ (–µ—Å–ª–∏ –±—É–¥–µ—Ç)
  'footer-height': 0px // –í—ã—Å–æ—Ç–∞ –ø–æ–¥–≤–∞–ª–∞
) !default;

// –ë—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã
$breakpoints: (
  'mobile': 768px,
  'tablet': 1024px,
  'desktop': 1440px,
  'large': 1920px
) !default;

// –†–∞–¥–∏—É—Å—ã –∑–∞–∫—Ä—É–≥–ª–µ–Ω–∏—è
$border-radius: (
  'sm': 4px,
  'md': 8px,
  'lg': 12px,
  'xl': 16px,
  'round': 50%
) !default;

// Z-index —Å–ª–æ–∏
$z-index: (
  'dropdown': 1000,
  'sticky': 1020,
  'fixed': 1030,
  'modal-backdrop': 1040,
  'modal': 1050,
  'popover': 1060,
  'tooltip': 1070
) !default;

// =============================================
// CSS –ü–ï–†–ï–ú–ï–ù–ù–´–ï (–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö)
// =============================================
:root {
  // =============================================
  // UI SCALE FACTOR
  // =============================================
  // Default scale (1 = 100%), JS will override based on viewport
  --ui-scale: 1;

  // –¶–≤–µ—Ç–∞
  @each $name, $value in $color {
    --color-#{$name}: #{$value};
  }
  @each $name, $value in $black {
    --black-#{$name}: #{$value};
  }

  // –û—Ç—Å—Ç—É–ø—ã (scaled)
  @each $name, $value in $spacing {
    --spacing-#{$name}: calc(var(--ui-scale) * #{$value});
  }

  // –†–∞–∑–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–∞ (scaled)
  @each $name, $value in $font-size {
    --text-#{$name}: calc(var(--ui-scale) * #{$value});
  }

  // Touch —Ä–∞–∑–º–µ—Ä—ã (scaled with minimum for accessibility)
  --touch-min: max(36px, calc(var(--ui-scale) * 44px));
  --touch-button: max(40px, calc(var(--ui-scale) * 48px));
  --touch-card: max(52px, calc(var(--ui-scale) * 64px));
  --touch-input: max(44px, calc(var(--ui-scale) * 56px));

  // POS Layout
  @each $name, $value in $pos-layout {
    --pos-#{$name}: #{$value};
  }

  // –†–∞–¥–∏—É—Å—ã
  @each $name, $value in $border-radius {
    --radius-#{$name}: #{$value};
  }

  // Z-index
  @each $name, $value in $z-index {
    --z-#{$name}: #{$value};
  }

  // –ë—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã (–¥–ª—è JavaScript)
  @each $name, $value in $breakpoints {
    --bp-#{$name}: #{$value};
  }
}

// =============================================
// CSS-ONLY FALLBACK FOR UI SCALING
// =============================================
// These media queries provide fallback scaling before JS loads
// JS will override --ui-scale dynamically when enabled
// data-scale-disabled attribute disables CSS scaling (set by JS when ENV.ui.autoScale=false)

@media (max-width: #{map.get($breakpoints, 'tablet') - 1px}) {
  :root:not([data-scale-disabled]) {
    --ui-scale: 0.9; // 90% at tablet and below
  }
}

@media (max-width: #{map.get($breakpoints, 'mobile') - 1px}) {
  :root:not([data-scale-disabled]) {
    --ui-scale: 0.85; // 85% at mobile
  }
}

// =============================================
// SASS –ú–ò–ö–°–ò–ù–´ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
// =============================================

// Touch-friendly —Ä–∞–∑–º–µ—Ä—ã
@mixin touch-target {
  min-height: map.get($touch, 'min');
  min-width: map.get($touch, 'min');
  cursor: pointer;
  touch-action: manipulation;
}

@mixin button-base {
  @include touch-target;
  min-height: map.get($touch, 'button');
  padding: map.get($spacing, 'sm') map.get($spacing, 'md');
  border-radius: map.get($border-radius, 'md');
  font-size: map.get($font-size, 'base');
}

@mixin card-base {
  min-height: map.get($touch, 'card');
  padding: map.get($spacing, 'md');
  border-radius: map.get($border-radius, 'lg');
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

// –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç
@mixin responsive-text($size: 'base') {
  font-size: map.get($font-size, $size);
}

// POS Layout –º–∏–∫—Å–∏–Ω
@mixin pos-sidebar {
  width: map.get($pos-layout, 'sidebar-width');
  max-width: map.get($pos-layout, 'sidebar-max-width');
  flex-shrink: 0;
  background: map.get($black, 'surface');
  border-right: 1px solid rgba(255, 255, 255, 0.12);
}

@mixin pos-section {
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: map.get($color, 'background');
}

// Responsive –º–∏–∫—Å–∏–Ω—ã
@mixin mobile-only {
  @media (max-width: #{map.get($breakpoints, 'mobile') - 1px}) {
    @content;
  }
}

@mixin tablet-up {
  @media (min-width: #{map.get($breakpoints, 'mobile')}) {
    @content;
  }
}

@mixin desktop-up {
  @media (min-width: #{map.get($breakpoints, 'tablet')}) {
    @content;
  }
}

// =============================================
// –≠–ö–°–ü–û–†–¢–´ –î–õ–Ø JAVASCRIPT (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ + –Ω–æ–≤—ã–µ)
// =============================================
:export {
  // –¶–≤–µ—Ç–∞ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)
  colorPrimary: map.get($color, 'primary');
  colorSecondary: map.get($color, 'secondary');
  colorBackground: map.get($color, 'background');
  colorSurface: map.get($color, 'surface');
  colorError: map.get($color, 'error');
  colorSuccess: map.get($color, 'success');
  colorWarning: map.get($color, 'warning');
  blackPrimary: map.get($black, 'primary');
  blackSurface: map.get($black, 'surface');

  // –†–∞–∑–º–µ—Ä—ã (–Ω–æ–≤—ã–µ)
  touchMin: map.get($touch, 'min');
  touchButton: map.get($touch, 'button');
  touchCard: map.get($touch, 'card');

  // –ë—Ä–µ–π–∫–ø–æ–∏–Ω—Ç—ã
  bpMobile: map.get($breakpoints, 'mobile');
  bpTablet: map.get($breakpoints, 'tablet');
  bpDesktop: map.get($breakpoints, 'desktop');

  // POS Layout
  posSidebarWidth: map.get($pos-layout, 'sidebar-width');
  posMenuFlex: map.get($pos-layout, 'menu-flex');
  posOrderFlex: map.get($pos-layout, 'order-flex');
}
