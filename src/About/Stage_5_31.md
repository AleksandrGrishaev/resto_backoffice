# üìã –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π Supplier Store - –§–∏–Ω–∞–ª—å–Ω–æ–µ –¢–ó

## üéØ –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

**–ú–ò–ù–ò–ú–ê–õ–ò–°–¢–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø** - —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª!

Supplier Store –æ—Ç–≤–µ—á–∞–µ—Ç **–¢–û–õ–¨–ö–û –∑–∞ workflow –∑–∞–∫–∞–∑–æ–≤**:

- ‚úÖ –ó–∞—è–≤–∫–∏ –Ω–∞ –∑–∞–∫–∞–∑ (ProcurementRequest)
- ‚úÖ –ó–∞–∫–∞–∑—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º (PurchaseOrder)
- ‚úÖ –ü—Ä–∏–µ–º–∫–∞ —Ç–æ–≤–∞—Ä–∞ (Receipt)

**–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—ã–Ω–µ—Å–µ–Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ Store:**

- üè™ **–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏** ‚Üí CounterAgentsStore
- üí∞ **–°—á–µ—Ç–∞/–ü–ª–∞—Ç–µ–∂–∏** ‚Üí AccountStore
- üì¶ **–ü—Ä–æ–¥—É–∫—Ç—ã** ‚Üí ProductsStore
- üè≠ **–°–∫–ª–∞–¥** ‚Üí StorageStore

**–ù–∏–∫–∞–∫–∏—Ö –ª–∏—à–Ω–∏—Ö —Ñ–∏—á:** —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, —Å–ª–æ–∂–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã, –¥–∞—à–±–æ—Ä–¥—ã - –¢–û–õ–¨–ö–û –±–∞–∑–æ–≤—ã–π workflow!

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/stores
  /supplier_2
    /composables
      useProcurementRequests.ts  // –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞—è–≤–∫–∞–º–∏
      usePurchaseOrders.ts       // –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–∫–∞–∑–∞–º–∏
      useReceipts.ts             // –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–∏–µ–º–∫–æ–π
      useOrderAssistant.ts       // –¥–ª—è –ø–æ–º–æ—â–Ω–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
    /mock
      supplierMock.ts
    index.ts
    types.ts
    supplierStore.ts
    supplierService.ts

/views
  /supplier_2
    /components
      /supplier_2
        BaseOrderAssistant.vue
        BaseSupplierBaskets.vue
        BaseReceiptDialog.vue
        ProcurementRequestTable.vue
        PurchaseOrderTable.vue
        ReceiptTable.vue
    SupplierView.vue
```

### **Composables —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

#### **useProcurementRequests.ts**

```typescript
export function useProcurementRequests() {
  // –†–∞–±–æ—Ç–∞ —Å –∑–∞—è–≤–∫–∞–º–∏:
  // - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫
  // - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞—è–≤–æ–∫
  // - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
  // - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
}
```

#### **usePurchaseOrders.ts**

```typescript
export function usePurchaseOrders() {
  // –†–∞–±–æ—Ç–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏:
  // - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –∑–∞—è–≤–æ–∫
  // - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏
  // - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AccountStore
  // - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
}
```

#### **useReceipts.ts**

```typescript
export function useReceipts() {
  // –†–∞–±–æ—Ç–∞ —Å –ø—Ä–∏–µ–º–∫–æ–π:
  // - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–µ–º–∫–∏
  // - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω/—Ñ–∞–∫—Ç
  // - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å StorageStore
  // - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω
}
```

#### **useOrderAssistant.ts**

```typescript
export function useOrderAssistant() {
  // –ü–æ–º–æ—â–Ω–∏–∫ –∑–∞–∫–∞–∑–æ–≤:
  // - –∞–Ω–∞–ª–∏–∑ –æ—Å—Ç–∞—Ç–∫–æ–≤
  // - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
  // - –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ü–µ–Ω
  // - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫
}
```

---

## üìä Complete WorkFlow

```mermaid
graph TD
    %% STEP 1: Order Assistant & Request Creation
    A[üë§ OrderAssistant in Suppliers] --> B[üìã Read StorageBalance & Products]
    B --> C[üí° Generate suggestions: low stock items]
    C --> D[‚úèÔ∏è User adjusts quantities & adds items]
    D --> E[‚úÖ Create ProcurementRequest]

    %% STEP 2: Supplier Assignment & Order Creation
    E --> F[üì¶ Group requests ‚Üí UnassignedItems]
    F --> G[üè™ UI: assign items to supplier baskets]
    G --> H[üí∞ Auto-fill prices from StorageOperations]
    H --> I[‚úèÔ∏è User can edit prices]
    I --> J[‚úÖ Create PurchaseOrder]

    %% STEP 3: Payment (Account Store)
    J --> K[üí≥ AUTO: Create PendingPayment]
    K --> L{üí∞ Finance processes payment?}
    L -->|Yes| M[‚úÖ PurchaseOrder.paymentStatus = 'paid']
    L -->|No| N[‚è≥ PurchaseOrder.paymentStatus = 'pending']

    %% STEP 4: Delivery & Receipt
    M --> O[üöö Goods delivered]
    N --> O
    O --> P[üì• Start Receipt process]
    P --> Q[‚öñÔ∏è Compare ordered vs received]
    Q --> R[üí∞ Update actual prices if changed]
    R --> S[‚úÖ Create Receipt + Complete]

    %% STEP 5: Storage Integration
    S --> T[üè™ AUTO: Create StorageOperation type='receipt']
    T --> U[üìà Update StorageBatch & StorageBalance]
    U --> V[üíæ New price history for future orders]
    V --> W[‚úÖ Complete workflow]

    %% Status Updates
    E -.-> EB[Request: submitted]
    J -.-> JB[Order: sent ‚Üí confirmed]
    S -.-> SB[Order: delivered]
    W -.-> WB[Request: converted]
```

---

## üèóÔ∏è TypeScript Types

### **1. Core Workflow Types**

```typescript
import type { BaseEntity } from '@/types/common'

// 1. –ó–∞—è–≤–∫–∞ –Ω–∞ –∑–∞–∫–∞–∑ (–æ—Ç –æ—Ç–¥–µ–ª–∞)
interface ProcurementRequest extends BaseEntity {
  requestNumber: string // "REQ-KITCHEN-001"
  department: 'kitchen' | 'bar'
  requestedBy: string

  items: RequestItem[]

  status: 'draft' | 'submitted' | 'converted' | 'cancelled'
  priority: 'normal' | 'urgent'

  // –°–≤—è–∑–∏
  purchaseOrderIds: string[] // PO —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–∑ —ç—Ç–æ–π –∑–∞—è–≤–∫–∏

  notes?: string
}

interface RequestItem {
  id: string
  itemId: string // —Å–≤—è–∑—å —Å Product –∏–∑ ProductsStore
  itemName: string // –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  requestedQuantity: number
  unit: string
  notes?: string
}

// 2. –ó–∞–∫–∞–∑ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É
interface PurchaseOrder extends BaseEntity {
  orderNumber: string // "PO-001"
  supplierId: string // —Å–≤—è–∑—å —Å Counteragent
  supplierName: string // –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ

  orderDate: string
  expectedDeliveryDate?: string

  items: OrderItem[]
  totalAmount: number // —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ items
  isEstimatedTotal: boolean // true –µ—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—ã

  status: 'draft' | 'sent' | 'confirmed' | 'delivered' | 'cancelled'
  paymentStatus: 'pending' | 'paid'

  // –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ Store
  requestIds: string[] // –æ—Ç–∫—É–¥–∞ —Å–æ–∑–¥–∞–Ω
  receiptId?: string // —Å–≤—è–∑—å —Å –ø—Ä–∏–µ–º–∫–æ–π
  billId?: string // —Å–≤—è–∑—å —Å–æ —Å—á–µ—Ç–æ–º –≤ Account Store (PendingPayment.id)

  notes?: string
}

interface OrderItem {
  id: string
  itemId: string // —Å–≤—è–∑—å —Å Product
  itemName: string
  orderedQuantity: number
  receivedQuantity?: number // –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–∏–µ–º–∫–µ
  unit: string
  pricePerUnit: number // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ Storage operations
  totalPrice: number // —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

  // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–µ–Ω–µ
  isEstimatedPrice: boolean // true –µ—Å–ª–∏ —Ü–µ–Ω–∞ –≤–∑—è—Ç–∞ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
  lastPriceDate?: string // –∫–æ–≥–¥–∞ –±—ã–ª–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞

  status: 'ordered' | 'received' | 'cancelled'
}

// 3. –ü—Ä–∏–µ–º–∫–∞ —Ç–æ–≤–∞—Ä–∞
interface Receipt extends BaseEntity {
  receiptNumber: string // "RCP-001"
  purchaseOrderId: string

  deliveryDate: string
  receivedBy: string

  items: ReceiptItem[]

  hasDiscrepancies: boolean
  status: 'draft' | 'completed'

  // –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–µ–º–∫–∏ - —Å–æ–∑–¥–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é –≤ Storage Store
  storageOperationId?: string // StorageOperation.id (type: 'receipt')

  notes?: string
}

interface ReceiptItem {
  id: string
  orderItemId: string
  itemId: string
  itemName: string

  orderedQuantity: number
  receivedQuantity: number

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø—Ä–∏ –ø—Ä–∏–µ–º–∫–µ
  orderedPrice: number // –∏–∑ –∑–∞–∫–∞–∑–∞
  actualPrice?: number // —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏

  notes?: string
}
```

### **2. Store State (–ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô)**

```typescript
interface SupplierState {
  // –î–∞–Ω–Ω—ã–µ
  requests: ProcurementRequest[]
  orders: PurchaseOrder[]
  receipts: Receipt[]

  // UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ)
  loading: {
    requests: boolean
    orders: boolean
    receipts: boolean
    suggestions: boolean
  }

  // –¢–µ–∫—É—â–∏–π workflow (—Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã)
  currentRequest?: ProcurementRequest
  currentOrder?: PurchaseOrder
  currentReceipt?: Receipt

  // –î–ª—è –ø–æ–º–æ—â–Ω–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤ (–º–∏–Ω–∏–º—É–º)
  selectedRequestIds: string[]
  orderSuggestions: OrderSuggestion[]

  // –î–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º (–º–∏–Ω–∏–º—É–º)
  supplierBaskets: SupplierBasket[]
}
```

### **3. Helper Types (–¢–û–õ–¨–ö–û –ù–ï–û–ë–•–û–î–ò–ú–´–ï)**

```typescript
// –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ–º–æ—â–Ω–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
interface OrderSuggestion {
  itemId: string
  itemName: string
  currentStock: number
  minStock: number
  suggestedQuantity: number
  urgency: 'low' | 'medium' | 'high'
  reason: 'below_minimum' | 'out_of_stock'
  estimatedPrice: number // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ Storage –æ–ø–µ—Ä–∞—Ü–∏–π
  lastPriceDate?: string
}

// –ö–æ—Ä–∑–∏–Ω—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –¥–ª—è UI —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
interface SupplierBasket {
  supplierId: string | null // null = "–ù–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ"
  supplierName: string
  items: UnassignedItem[]
  totalItems: number
  estimatedTotal: number // —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ –ø—Ä–æ—à–ª—ã—Ö —Ü–µ–Ω
}

interface UnassignedItem {
  itemId: string
  itemName: string
  category: string // Product.category –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  totalQuantity: number
  unit: string
  estimatedPrice: number // –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ Storage –æ–ø–µ—Ä–∞—Ü–∏–π

  // –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∑–∞—è–≤–æ–∫
  sources: {
    requestId: string
    requestNumber: string
    department: 'kitchen' | 'bar'
    quantity: number
  }[]
}
```

### **4. Create/Update Types (–ë–ê–ó–û–í–´–ï)**

```typescript
interface CreateRequestData {
  department: 'kitchen' | 'bar'
  requestedBy: string
  items: Omit<RequestItem, 'id'>[]
  priority?: 'normal' | 'urgent'
  notes?: string
}

interface CreateOrderData {
  supplierId: string
  requestIds: string[]
  items: {
    itemId: string
    quantity: number
    pricePerUnit: number // –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
  }[]
  expectedDeliveryDate?: string
  notes?: string
}

interface CreateReceiptData {
  purchaseOrderId: string
  receivedBy: string
  items: {
    orderItemId: string
    receivedQuantity: number
    actualPrice?: number // –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
    notes?: string
  }[]
  notes?: string
}
```

### **5. Integration Types (–¢–û–õ–¨–ö–û –°–í–Ø–ó–ò)**

```typescript
// –°–≤—è–∑–∏ —Å ProductsStore
interface ProductInfo {
  id: string // Product.id
  name: string // Product.name
  category: string // Product.category
  unit: string // Product.unit
  isActive: boolean // Product.isActive
  canBeSold: boolean // Product.canBeSold
}

// –°–≤—è–∑–∏ —Å CounterAgentsStore
interface SupplierInfo {
  id: string // Counteragent.id
  name: string // Counteragent.name
  displayName: string // Counteragent.displayName
  type: 'supplier' // Counteragent.type
  paymentTerms: string // Counteragent.paymentTerms
  isActive: boolean // Counteragent.isActive
}

// –°–≤—è–∑–∏ —Å StorageStore –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω
interface PriceHistory {
  itemId: string
  supplierId?: string
  pricePerUnit: number
  date: string
  operationId: string // StorageOperation.id
}

// –°–≤—è–∑–∏ —Å AccountStore –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—á–µ—Ç–æ–≤
interface CreateBillInAccountStore {
  counteragentId: string // supplierId
  counteragentName: string // supplierName
  amount: number // PurchaseOrder.totalAmount
  description: string // "–ó–∞–∫–∞–∑ #{orderNumber}"
  category: 'supplier' // PendingPayment.category
  invoiceNumber?: string // PurchaseOrder.orderNumber
  purchaseOrderId: string // metadata –¥–ª—è —Å–≤—è–∑–∏
}

// –°–≤—è–∑–∏ —Å StorageStore –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è
interface CreateStorageReceipt {
  department: 'kitchen' | 'bar'
  responsiblePerson: string
  items: {
    itemId: string
    quantity: number
    costPerUnit: number // actualPrice –∏–ª–∏ orderedPrice
    notes?: string
  }[]
  sourceType: 'purchase' // BatchSourceType
  purchaseOrderId: string // –¥–ª—è —Å–≤—è–∑–∏
}
```

---

## üîó Store Integrations (–¢–û–õ–¨–ö–û –ß–¢–ï–ù–ò–ï/–ó–ê–ü–ò–°–¨)

### **1. ProductsStore Integration**

#### **Supplier ‚Üí ProductsStore (Read):**

```typescript
// OrderAssistant gets available products
function getAvailableProducts(department: 'kitchen' | 'bar'): ProductInfo[] {
  if (department === 'kitchen') {
    // –°—ã—Ä—å–µ –¥–ª—è –≥–æ—Ç–æ–≤–∫–∏ (–Ω–µ –ø—Ä–æ–¥–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é)
    return productsStore.rawProducts.filter(p => p.isActive)
  } else {
    // –ù–∞–ø–∏—Ç–∫–∏ –¥–ª—è –±–∞—Ä–∞ (–ø—Ä–æ–¥–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é)
    return productsStore.sellableProducts.filter(p => p.isActive && p.category === 'beverages')
  }
}

// Get product details for UI
function getProductInfo(itemId: string): ProductInfo {
  const product = productsStore.getProductById(itemId)
  return {
    id: product.id,
    name: product.name,
    category: product.category,
    unit: product.unit,
    isActive: product.isActive,
    canBeSold: product.canBeSold
  }
}
```

### **2. StorageStore Integration**

#### **StorageStore ‚Üí Supplier (Read for suggestions):**

```typescript
// Get current stock levels for OrderAssistant
function getOrderSuggestions(department: 'kitchen' | 'bar'): OrderSuggestion[] {
  const balances = storageStore.departmentBalances(department)

  return balances
    .filter(balance => balance.belowMinStock || balance.totalQuantity === 0)
    .map(balance => ({
      itemId: balance.itemId,
      itemName: balance.itemName,
      currentStock: balance.totalQuantity,
      minStock: getMinStock(balance.itemId), // from Product
      suggestedQuantity: calculateSuggestion(balance),
      urgency: balance.totalQuantity === 0 ? 'high' : 'medium',
      reason: balance.totalQuantity === 0 ? 'out_of_stock' : 'below_minimum',
      estimatedPrice: balance.latestCost, // –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∏–∑ StorageBalance
      lastPriceDate: balance.newestBatchDate
    }))
}

// Get price history for auto-filling order prices
function getLastPrice(itemId: string, supplierId?: string): number {
  // –ò—â–µ–º –≤ StorageOperations type='receipt' –ø–æ—Å–ª–µ–¥–Ω—é—é —Ü–µ–Ω—É
  const operations = storageStore.operations.filter(
    op => op.operationType === 'receipt' && op.items.some(item => item.itemId === itemId)
  )

  // –ï—Å–ª–∏ –µ—Å—Ç—å supplierId, —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É —á–µ—Ä–µ–∑ metadata
  // –ò–Ω–∞—á–µ –±–µ—Ä–µ–º —Å–∞–º—É—é –ø–æ—Å–ª–µ–¥–Ω—é—é —Ü–µ–Ω—É
  return operations[0]?.items.find(item => item.itemId === itemId)?.averageCostPerUnit || 0
}
```

#### **Supplier ‚Üí StorageStore (Write on receipt):**

```typescript
// When receipt is completed, create StorageOperation
function createStorageReceipt(receipt: Receipt): Promise<StorageOperation> {
  const createData: CreateStorageReceipt = {
    department: receipt.department, // from PurchaseOrder
    responsiblePerson: receipt.receivedBy,
    items: receipt.items.map(item => ({
      itemId: item.itemId,
      quantity: item.receivedQuantity,
      costPerUnit: item.actualPrice || item.orderedPrice,
      notes: `PO: ${receipt.purchaseOrderId}`
    })),
    sourceType: 'purchase',
    purchaseOrderId: receipt.purchaseOrderId
  }

  return storageStore.createReceipt(createData)
}
```

### **3. CounterAgentsStore Integration**

#### **CounterAgentsStore ‚Üí Supplier (Read suppliers):**

```typescript
// Get available suppliers for assignment
function getActiveSuppliers(): SupplierInfo[] {
  return counteragentsStore.supplierCounterAgents.map(supplier => ({
    id: supplier.id,
    name: supplier.name,
    displayName: supplier.displayName,
    type: 'supplier',
    paymentTerms: supplier.paymentTerms,
    isActive: supplier.isActive
  }))
}

// Get supplier for basket naming
function getSupplierInfo(supplierId: string): SupplierInfo {
  const supplier = counteragentsStore.getCounteragentById(supplierId)
  return {
    id: supplier.id,
    name: supplier.name,
    displayName: supplier.displayName
    // ... other fields
  }
}
```

### **4. AccountStore Integration**

#### **Supplier ‚Üí AccountStore (Write bills):**

```typescript
// When PurchaseOrder is created, AUTOMATICALLY create PendingPayment
function createBillInAccount(order: PurchaseOrder): Promise<PendingPayment> {
  const billData: CreateBillInAccountStore = {
    counteragentId: order.supplierId,
    counteragentName: order.supplierName,
    amount: order.totalAmount,
    description: `–ó–∞–∫–∞–∑ ${order.orderNumber}`,
    category: 'supplier',
    invoiceNumber: order.orderNumber,
    purchaseOrderId: order.id, // metadata –¥–ª—è —Å–≤—è–∑–∏
    priority: 'medium', // default
    createdBy: {
      type: 'user',
      id: getCurrentUser().id,
      name: getCurrentUser().name
    }
  }

  return accountStore.createPayment(billData)
}
```

#### **AccountStore ‚Üí Supplier (Payment confirmation):**

```typescript
// When payment is processed, automatically update PurchaseOrder
function onPaymentProcessed(paymentId: string, transactionId: string) {
  // Find PurchaseOrder by billId
  const order = supplierStore.orders.find(o => o.billId === paymentId)
  if (order) {
    supplierStore.updateOrderPaymentStatus(order.id, 'paid')
  }
}
```

---

## üí∞ Payment Flow - –î–µ—Ç–∞–ª—å–Ω–æ

### **Step 3a: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–∞**

```typescript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PurchaseOrder –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
async function createPurchaseOrder(orderData: CreateOrderData) {
  // 1. –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
  const order = await supplierService.createOrder(orderData)

  // 2. –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò —Å–æ–∑–¥–∞–µ–º —Å—á–µ—Ç –≤ Account Store
  const billData: CreatePaymentDto = {
    counteragentId: order.supplierId,
    counteragentName: order.supplierName,
    amount: order.totalAmount,
    description: `–ó–∞–∫–∞–∑ ${order.orderNumber}`,
    category: 'supplier',
    invoiceNumber: order.orderNumber,
    priority: 'medium', // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    createdBy: currentUser
  }

  const bill = await accountStore.createPayment(billData)

  // 3. –°–≤—è–∑—ã–≤–∞–µ–º –∑–∞–∫–∞–∑ —Å–æ —Å—á–µ—Ç–æ–º
  order.billId = bill.id
  order.paymentStatus = 'pending'

  return order
}
```

### **Step 3b: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã (–æ—Ç–¥–µ–ª—å–Ω–æ)**

```typescript
// –ü–æ–∑–∂–µ, –≤ Account Store, finance manager:
async function processPayment(paymentId: string, accountId: string) {
  // 1. –ü—Ä–æ–≤–æ–¥–∏—Ç –ø–ª–∞—Ç–µ–∂
  await accountStore.processPayment({
    paymentId,
    accountId,
    performedBy: financeManager
  })

  // 2. –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
  const order = supplierStore.orders.find(o => o.billId === paymentId)
  if (order) {
    order.paymentStatus = 'paid'
  }
}
```

### **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É Store:**

```typescript
// –í supplierStore, —Å–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ accountStore
watch(
  () => accountStore.pendingPayments,
  payments => {
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π
    payments.forEach(payment => {
      const order = orders.find(o => o.billId === payment.id)
      if (order && payment.status === 'completed') {
        order.paymentStatus = 'paid'
      }
    })
  }
)
```

---

## üé® UI Structure (–ú–ò–ù–ò–ú–ê–õ–¨–ù–ê–Ø)

### **Navigation:**

```
üè† Dashboard
üì¶ Storage          ‚¨ÖÔ∏è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π (OrderAssistant —É–±–∏—Ä–∞–µ–º –æ—Ç—Å—é–¥–∞)
üõí Suppliers        ‚¨ÖÔ∏è –ù–û–í–´–ô –º–æ–¥—É–ª—å (—Å OrderAssistant –≤–Ω—É—Ç—Ä–∏)
üí∞ Accounts         ‚¨ÖÔ∏è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
üë• Staff
üìä Reports
‚öôÔ∏è Settings
```

### **SupplierView Structure (–ü–†–û–°–¢–ê–Ø):**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üõí Suppliers & Orders                       ‚îÇ
‚îÇ ‚îú‚îÄ Tabs: [üìã Requests] [üì¶ Orders]         ‚îÇ
‚îÇ ‚îÇ         [üì• Receipts]                     ‚îÇ
‚îÇ ‚îÇ                                          ‚îÇ
‚îÇ ‚îú‚îÄ Quick Actions:                          ‚îÇ
‚îÇ ‚îÇ  [üõí Order Assistant]                    ‚îÇ
‚îÇ ‚îÇ                                          ‚îÇ
‚îÇ ‚îî‚îÄ Tab Content (–ø—Ä–æ—Å—Ç—ã–µ —Ç–∞–±–ª–∏—Ü—ã)           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **OrderAssistant (–ø—Ä–æ—Å—Ç–æ–π modal):**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üõí Order Assistant - Kitchen                ‚îÇ
‚îÇ ‚îú‚îÄ Department: [Kitchen ‚ñº] [Bar]           ‚îÇ
‚îÇ ‚îú‚îÄ Auto Suggestions:                       ‚îÇ
‚îÇ ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ  ‚îÇ ‚ö†Ô∏è Low Stock: Beef (0.3kg)          ‚îÇ ‚îÇ
‚îÇ ‚îÇ  ‚îÇ Suggested: [5] kg @ 180k            ‚îÇ ‚îÇ
‚îÇ ‚îÇ  ‚îÇ [‚úì Add]                             ‚îÇ ‚îÇ
‚îÇ ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ ‚îÇ                                          ‚îÇ
‚îÇ ‚îú‚îÄ Manual Add: [+ Add item ‚ñº]             ‚îÇ
‚îÇ ‚îî‚îÄ [Cancel] [Create Request]               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **Supplier Assignment (–ø—Ä–æ—Å—Ç–æ–π):**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üì¶ Create Orders from Requests              ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ ‚îå‚îÄ –ù–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ ‚îÇ ‚òê Beef (5kg) @ 180k                     ‚îÇ‚îÇ
‚îÇ ‚îÇ ‚òê Milk (8L) @ 15k                       ‚îÇ‚îÇ
‚îÇ ‚îÇ [Assign to ‚ñº]                           ‚îÇ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ ‚îå‚îÄ Premium Meat Co ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ ‚îÇ ‚Ä¢ Beef (2kg) @ 180k                     ‚îÇ‚îÇ
‚îÇ ‚îÇ [Create Order]                          ‚îÇ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìÖ Implementation Roadmap (–§–û–ö–£–° –ù–ê –ú–ò–ù–ò–ú–£–ú)

### **Week 1: Mock Data & Basic Store**

- [ ] üî≤ `supplierMock.ts` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- [ ] üî≤ `types.ts` - —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∏–ø—ã
- [ ] üî≤ `supplierService.ts` - –±–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Å –º–æ–∫–∞–º–∏
- [ ] üî≤ `supplierStore.ts` - –ø—Ä–æ—Å—Ç–æ–π store –±–µ–∑ –∏–∑–ª–∏—à–µ—Å—Ç–≤

### **Week 2: Composables & OrderAssistant**

- [ ] üî≤ `useOrderAssistant.ts` - –ª–æ–≥–∏–∫–∞ –ø–æ–º–æ—â–Ω–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
- [ ] üî≤ `useProcurementRequests.ts` - —Ä–∞–±–æ—Ç–∞ —Å –∑–∞—è–≤–∫–∞–º–∏
- [ ] üî≤ `BaseOrderAssistant.vue` - –ø—Ä–æ—Å—Ç–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- [ ] üî≤ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å StorageStore –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫

### **Week 3: Orders & Supplier Assignment**

- [ ] üî≤ `usePurchaseOrders.ts` - —Ä–∞–±–æ—Ç–∞ —Å –∑–∞–∫–∞–∑–∞–º–∏
- [ ] üî≤ `BaseSupplierBaskets.vue` - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º
- [ ] üî≤ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CounterAgentsStore
- [ ] üî≤ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AccountStore (—Å–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–æ–≤)

### **Week 4: Receipts & Storage Integration**

- [ ] üî≤ `useReceipts.ts` - —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–∏–µ–º–∫–æ–π
- [ ] üî≤ `BaseReceiptDialog.vue` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–µ–º–∫–∏
- [ ] üî≤ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å StorageStore (—Å–æ–∑–¥–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π)
- [ ] üî≤ –ü–æ–ª–Ω—ã–π workflow —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **Week 5: UI & Polish**

- [ ] üî≤ `SupplierView.vue` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- [ ] üî≤ –ü—Ä–æ—Å—Ç—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏
- [ ] üî≤ –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ —Ä–æ—É—Ç–∏–Ω–≥
- [ ] üî≤ –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéØ Composables Details

### **1. useOrderAssistant.ts**

```typescript
export function useOrderAssistant() {
  // State
  const suggestions = ref<OrderSuggestion[]>([])
  const selectedItems = ref<RequestItem[]>([])
  const isGenerating = ref(false)

  // Actions
  async function generateSuggestions(department: 'kitchen' | 'bar') {
    // –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ StorageStore
    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Å—Ç–∞—Ç–∫–∏ vs –º–∏–Ω–∏–º—É–º—ã
    // –ü–æ–ª—É—á–∞–µ–º —Ü–µ–Ω—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
  }

  function addSuggestionToRequest(suggestion: OrderSuggestion) {
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∑–∞—è–≤–∫—É
  }

  async function createRequestFromItems(data: CreateRequestData) {
    // –°–æ–∑–¥–∞–µ–º –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ supplierStore
  }

  return {
    suggestions,
    selectedItems,
    isGenerating,
    generateSuggestions,
    addSuggestionToRequest,
    createRequestFromItems
  }
}
```

### **2. useProcurementRequests.ts**

```typescript
export function useProcurementRequests() {
  // State
  const requests = computed(() => supplierStore.requests)
  const currentRequest = computed(() => supplierStore.currentRequest)

  // Actions
  async function createRequest(data: CreateRequestData) {
    return supplierStore.createRequest(data)
  }

  async function updateRequestStatus(id: string, status: RequestStatus) {
    return supplierStore.updateRequestStatus(id, status)
  }

  function groupRequestsForOrders(requestIds: string[]): SupplierBasket[] {
    // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—ã –¥–ª—è UI
  }

  return {
    requests,
    currentRequest,
    createRequest,
    updateRequestStatus,
    groupRequestsForOrders
  }
}
```

### **3. usePurchaseOrders.ts**

```typescript
export function usePurchaseOrders() {
  // State
  const orders = computed(() => supplierStore.orders)
  const currentOrder = computed(() => supplierStore.currentOrder)

  // Actions
  async function createOrderFromBasket(basket: SupplierBasket) {
    // –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º —Å—á–µ—Ç –≤ AccountStore
    return supplierStore.createOrder(orderData)
  }

  async function updateOrderStatus(id: string, status: OrderStatus) {
    return supplierStore.updateOrderStatus(id, status)
  }

  function getOrdersWithPaymentStatus() {
    // –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å AccountStore
    return orders.value.map(order => ({
      ...order,
      paymentInfo: getPaymentInfo(order.billId)
    }))
  }

  return {
    orders,
    currentOrder,
    createOrderFromBasket,
    updateOrderStatus,
    getOrdersWithPaymentStatus
  }
}
```

### **4. useReceipts.ts**

```typescript
export function useReceipts() {
  // State
  const receipts = computed(() => supplierStore.receipts)
  const currentReceipt = computed(() => supplierStore.currentReceipt)

  // Actions
  async function startReceipt(purchaseOrderId: string) {
    return supplierStore.startReceipt(purchaseOrderId)
  }

  async function completeReceipt(receiptData: CreateReceiptData) {
    // –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–∏–µ–º–∫—É
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º StorageOperation
    return supplierStore.completeReceipt(receiptData)
  }

  function calculateDiscrepancies(receipt: Receipt): DiscrepancySummary {
    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –≤–ª–∏—è–Ω–∏–µ
  }

  return {
    receipts,
    currentReceipt,
    startReceipt,
    completeReceipt,
    calculateDiscrepancies
  }
}
```

-# üìã –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π Supplier Store - –§–∏–Ω–∞–ª—å–Ω–æ–µ –¢–ó

## üéØ –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

Supplier Store –æ—Ç–≤–µ—á–∞–µ—Ç **–¢–û–õ–¨–ö–û –∑–∞ workflow –∑–∞–∫–∞–∑–æ–≤**:

- ‚úÖ –ó–∞—è–≤–∫–∏ –Ω–∞ –∑–∞–∫–∞–∑ (ProcurementRequest)
- ‚úÖ –ó–∞–∫–∞–∑—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º (PurchaseOrder)
- ‚úÖ –ü—Ä–∏–µ–º–∫–∞ —Ç–æ–≤–∞—Ä–∞ (Receipt)

**–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—ã–Ω–µ—Å–µ–Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ Store:**

- üè™ **–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏** ‚Üí CounterAgentsStore
- üí∞ **–°—á–µ—Ç–∞/–ü–ª–∞—Ç–µ–∂–∏** ‚Üí AccountStore
- üì¶ **–ü—Ä–æ–¥—É–∫—Ç—ã** ‚Üí ProductsStore
- üè≠ **–°–∫–ª–∞–¥** ‚Üí StorageStore

---

## üìä Complete WorkFlow

```mermaid
graph TD
    %% STEP 1: Order Assistant & Request Creation
    A[üë§ OrderAssistant in Suppliers] --> B[üìã Read StorageBalance & Products]
    B --> C[üí° Generate suggestions: low stock items]
    C --> D[‚úèÔ∏è User adjusts quantities & adds items]
    D --> E[‚úÖ Create ProcurementRequest]

    %% STEP 2: Supplier Assignment & Order Creation
    E --> F[üì¶ Group requests ‚Üí UnassignedItems]
    F --> G[üè™ UI: assign items to supplier baskets]
    G --> H[üí∞ Auto-fill prices from StorageOperations]
    H --> I[‚úèÔ∏è User can edit prices]
    I --> J[‚úÖ Create PurchaseOrder]

    %% STEP 3: Payment (Account Store)
    J --> K[üí≥ AUTO: Create PendingPayment]
    K --> L{üí∞ Finance processes payment?}
    L -->|Yes| M[‚úÖ PurchaseOrder.paymentStatus = 'paid']
    L -->|No| N[‚è≥ PurchaseOrder.paymentStatus = 'pending']

    %% STEP 4: Delivery & Receipt
    M --> O[üöö Goods delivered]
    N --> O
    O --> P[üì• Start Receipt process]
    P --> Q[‚öñÔ∏è Compare ordered vs received]
    Q --> R[üí∞ Update actual prices if changed]
    R --> S[‚úÖ Create Receipt + Complete]

    %% STEP 5: Storage Integration
    S --> T[üè™ AUTO: Create StorageOperation type='receipt']
    T --> U[üìà Update StorageBatch & StorageBalance]
    U --> V[üíæ New price history for future orders]
    V --> W[‚úÖ Complete workflow]

    %% Status Updates
    E -.-> EB[Request: submitted]
    J -.-> JB[Order: sent ‚Üí confirmed]
    S -.-> SB[Order: delivered]
    W -.-> WB[Request: converted]
```

---

## üèóÔ∏è TypeScript Types

### **1. Core Workflow Types**

```typescript
import type { BaseEntity } from '@/types/common'

// 1. –ó–∞—è–≤–∫–∞ –Ω–∞ –∑–∞–∫–∞–∑ (–æ—Ç –æ—Ç–¥–µ–ª–∞)
interface ProcurementRequest extends BaseEntity {
  requestNumber: string // "REQ-KITCHEN-001"
  department: 'kitchen' | 'bar'
  requestedBy: string

  items: RequestItem[]

  status: 'draft' | 'submitted' | 'converted' | 'cancelled'
  priority: 'normal' | 'urgent'

  // –°–≤—è–∑–∏
  purchaseOrderIds: string[] // PO —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–∑ —ç—Ç–æ–π –∑–∞—è–≤–∫–∏

  notes?: string
}

interface RequestItem {
  id: string
  itemId: string // —Å–≤—è–∑—å —Å Product –∏–∑ ProductsStore
  itemName: string // –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  requestedQuantity: number
  unit: string
  notes?: string
}

// 2. –ó–∞–∫–∞–∑ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É
interface PurchaseOrder extends BaseEntity {
  orderNumber: string // "PO-001"
  supplierId: string // —Å–≤—è–∑—å —Å Counteragent
  supplierName: string // –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ

  orderDate: string
  expectedDeliveryDate?: string

  items: OrderItem[]
  totalAmount: number // —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ items
  isEstimatedTotal: boolean // true –µ—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—ã

  status: 'draft' | 'sent' | 'confirmed' | 'delivered' | 'cancelled'
  paymentStatus: 'pending' | 'paid'

  // –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ Store
  requestIds: string[] // –æ—Ç–∫—É–¥–∞ —Å–æ–∑–¥–∞–Ω
  receiptId?: string // —Å–≤—è–∑—å —Å –ø—Ä–∏–µ–º–∫–æ–π
  billId?: string // —Å–≤—è–∑—å —Å–æ —Å—á–µ—Ç–æ–º –≤ Account Store (PendingPayment.id)

  notes?: string
}

interface OrderItem {
  id: string
  itemId: string // —Å–≤—è–∑—å —Å Product
  itemName: string
  orderedQuantity: number
  receivedQuantity?: number // –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–∏–µ–º–∫–µ
  unit: string
  pricePerUnit: number // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ Storage operations
  totalPrice: number // —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

  // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–µ–Ω–µ
  isEstimatedPrice: boolean // true –µ—Å–ª–∏ —Ü–µ–Ω–∞ –≤–∑—è—Ç–∞ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
  lastPriceDate?: string // –∫–æ–≥–¥–∞ –±—ã–ª–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞

  status: 'ordered' | 'received' | 'cancelled'
}

// 3. –ü—Ä–∏–µ–º–∫–∞ —Ç–æ–≤–∞—Ä–∞
interface Receipt extends BaseEntity {
  receiptNumber: string // "RCP-001"
  purchaseOrderId: string

  deliveryDate: string
  receivedBy: string

  items: ReceiptItem[]

  hasDiscrepancies: boolean
  status: 'draft' | 'completed'

  // –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–µ–º–∫–∏ - —Å–æ–∑–¥–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é –≤ Storage Store
  storageOperationId?: string // StorageOperation.id (type: 'receipt')

  notes?: string
}

interface ReceiptItem {
  id: string
  orderItemId: string
  itemId: string
  itemName: string

  orderedQuantity: number
  receivedQuantity: number

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø—Ä–∏ –ø—Ä–∏–µ–º–∫–µ
  orderedPrice: number // –∏–∑ –∑–∞–∫–∞–∑–∞
  actualPrice?: number // —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏

  notes?: string
}
```

### **2. Store State**

```typescript
interface SupplierState {
  // –î–∞–Ω–Ω—ã–µ
  requests: ProcurementRequest[]
  orders: PurchaseOrder[]
  receipts: Receipt[]

  // UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  loading: {
    requests: boolean
    orders: boolean
    receipts: boolean
    suggestions: boolean
  }

  // –¢–µ–∫—É—â–∏–π workflow
  currentRequest?: ProcurementRequest
  currentOrder?: PurchaseOrder
  currentReceipt?: Receipt

  // –î–ª—è –ø–æ–º–æ—â–Ω–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
  selectedRequestIds: string[]
  orderSuggestions: OrderSuggestion[]

  // –î–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º
  supplierBaskets: SupplierBasket[]
}
```

### **3. Helper Types**

```typescript
// –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ–º–æ—â–Ω–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤
interface OrderSuggestion {
  itemId: string
  itemName: string
  currentStock: number
  minStock: number
  suggestedQuantity: number
  urgency: 'low' | 'medium' | 'high'
  reason: 'below_minimum' | 'out_of_stock'
  estimatedPrice: number // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ Storage –æ–ø–µ—Ä–∞—Ü–∏–π
  lastPriceDate?: string
}

// –ö–æ—Ä–∑–∏–Ω—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –¥–ª—è UI —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
interface SupplierBasket {
  supplierId: string | null // null = "–ù–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ"
  supplierName: string
  items: UnassignedItem[]
  totalItems: number
  estimatedTotal: number // —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ –ø—Ä–æ—à–ª—ã—Ö —Ü–µ–Ω
}

interface UnassignedItem {
  itemId: string
  itemName: string
  category: string // Product.category –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  totalQuantity: number
  unit: string
  estimatedPrice: number // –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ Storage –æ–ø–µ—Ä–∞—Ü–∏–π

  // –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∑–∞—è–≤–æ–∫
  sources: {
    requestId: string
    requestNumber: string
    department: 'kitchen' | 'bar'
    quantity: number
  }[]
}
```

### **4. Create/Update Types**

```typescript
interface CreateRequestData {
  department: 'kitchen' | 'bar'
  requestedBy: string
  items: Omit<RequestItem, 'id'>[]
  priority?: 'normal' | 'urgent'
  notes?: string
}

interface CreateOrderData {
  supplierId: string
  requestIds: string[]
  items: {
    itemId: string
    quantity: number
    pricePerUnit: number // –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
  }[]
  expectedDeliveryDate?: string
  notes?: string
}

interface CreateReceiptData {
  purchaseOrderId: string
  receivedBy: string
  items: {
    orderItemId: string
    receivedQuantity: number
    actualPrice?: number // –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞
    notes?: string
  }[]
  notes?: string
}
```

### **5. Integration Types**

```typescript
// –°–≤—è–∑–∏ —Å ProductsStore
interface ProductInfo {
  id: string // Product.id
  name: string // Product.name
  category: string // Product.category
  unit: string // Product.unit
  isActive: boolean // Product.isActive
  canBeSold: boolean // Product.canBeSold
}

// –°–≤—è–∑–∏ —Å CounterAgentsStore
interface SupplierInfo {
  id: string // Counteragent.id
  name: string // Counteragent.name
  displayName: string // Counteragent.displayName
  type: 'supplier' // Counteragent.type
  paymentTerms: string // Counteragent.paymentTerms
  isActive: boolean // Counteragent.isActive
}

// –°–≤—è–∑–∏ —Å StorageStore –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω
interface PriceHistory {
  itemId: string
  supplierId?: string
  pricePerUnit: number
  date: string
  operationId: string // StorageOperation.id
}

// –°–≤—è–∑–∏ —Å AccountStore –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—á–µ—Ç–æ–≤
interface CreateBillInAccountStore {
  counteragentId: string // supplierId
  counteragentName: string // supplierName
  amount: number // PurchaseOrder.totalAmount
  description: string // "–ó–∞–∫–∞–∑ #{orderNumber}"
  category: 'supplier' // PendingPayment.category
  invoiceNumber?: string // PurchaseOrder.orderNumber
  purchaseOrderId: string // metadata –¥–ª—è —Å–≤—è–∑–∏
}

// –°–≤—è–∑–∏ —Å StorageStore –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è
interface CreateStorageReceipt {
  department: 'kitchen' | 'bar'
  responsiblePerson: string
  items: {
    itemId: string
    quantity: number
    costPerUnit: number // actualPrice –∏–ª–∏ orderedPrice
    notes?: string
  }[]
  sourceType: 'purchase' // BatchSourceType
  purchaseOrderId: string // –¥–ª—è —Å–≤—è–∑–∏
}
```

---

## üîó Store Integrations

### **1. ProductsStore Integration**

#### **Supplier ‚Üí ProductsStore (Read):**

```typescript
// OrderAssistant gets available products
function getAvailableProducts(department: 'kitchen' | 'bar'): ProductInfo[] {
  if (department === 'kitchen') {
    // –°—ã—Ä—å–µ –¥–ª—è –≥–æ—Ç–æ–≤–∫–∏ (–Ω–µ –ø—Ä–æ–¥–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é)
    return productsStore.rawProducts.filter(p => p.isActive)
  } else {
    // –ù–∞–ø–∏—Ç–∫–∏ –¥–ª—è –±–∞—Ä–∞ (–ø—Ä–æ–¥–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é)
    return productsStore.sellableProducts.filter(p => p.isActive && p.category === 'beverages')
  }
}

// Get product details for UI
function getProductInfo(itemId: string): ProductInfo {
  const product = productsStore.getProductById(itemId)
  return {
    id: product.id,
    name: product.name,
    category: product.category,
    unit: product.unit,
    isActive: product.isActive,
    canBeSold: product.canBeSold
  }
}
```

### **2. StorageStore Integration**

#### **StorageStore ‚Üí Supplier (Read for suggestions):**

```typescript
// Get current stock levels for OrderAssistant
function getOrderSuggestions(department: 'kitchen' | 'bar'): OrderSuggestion[] {
  const balances = storageStore.departmentBalances(department)

  return balances
    .filter(balance => balance.belowMinStock || balance.totalQuantity === 0)
    .map(balance => ({
      itemId: balance.itemId,
      itemName: balance.itemName,
      currentStock: balance.totalQuantity,
      minStock: getMinStock(balance.itemId), // from Product
      suggestedQuantity: calculateSuggestion(balance),
      urgency: balance.totalQuantity === 0 ? 'high' : 'medium',
      reason: balance.totalQuantity === 0 ? 'out_of_stock' : 'below_minimum',
      estimatedPrice: balance.latestCost, // –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∏–∑ StorageBalance
      lastPriceDate: balance.newestBatchDate
    }))
}

// Get price history for auto-filling order prices
function getLastPrice(itemId: string, supplierId?: string): number {
  // –ò—â–µ–º –≤ StorageOperations type='receipt' –ø–æ—Å–ª–µ–¥–Ω—é—é —Ü–µ–Ω—É
  const operations = storageStore.operations.filter(
    op => op.operationType === 'receipt' && op.items.some(item => item.itemId === itemId)
  )

  // –ï—Å–ª–∏ –µ—Å—Ç—å supplierId, —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É —á–µ—Ä–µ–∑ metadata
  // –ò–Ω–∞—á–µ –±–µ—Ä–µ–º —Å–∞–º—É—é –ø–æ—Å–ª–µ–¥–Ω—é—é —Ü–µ–Ω—É
  return operations[0]?.items.find(item => item.itemId === itemId)?.averageCostPerUnit || 0
}
```

#### **Supplier ‚Üí StorageStore (Write on receipt):**

```typescript
// When receipt is completed, create StorageOperation
function createStorageReceipt(receipt: Receipt): Promise<StorageOperation> {
  const createData: CreateStorageReceipt = {
    department: receipt.department, // from PurchaseOrder
    responsiblePerson: receipt.receivedBy,
    items: receipt.items.map(item => ({
      itemId: item.itemId,
      quantity: item.receivedQuantity,
      costPerUnit: item.actualPrice || item.orderedPrice,
      notes: `PO: ${receipt.purchaseOrderId}`
    })),
    sourceType: 'purchase',
    purchaseOrderId: receipt.purchaseOrderId
  }

  return storageStore.createReceipt(createData)
}
```

### **3. CounterAgentsStore Integration**

#### **CounterAgentsStore ‚Üí Supplier (Read suppliers):**

```typescript
// Get available suppliers for assignment
function getActiveSuppliers(): SupplierInfo[] {
  return counteragentsStore.supplierCounterAgents.map(supplier => ({
    id: supplier.id,
    name: supplier.name,
    displayName: supplier.displayName,
    type: 'supplier',
    paymentTerms: supplier.paymentTerms,
    isActive: supplier.isActive
  }))
}

// Get supplier for basket naming
function getSupplierInfo(supplierId: string): SupplierInfo {
  const supplier = counteragentsStore.getCounteragentById(supplierId)
  return {
    id: supplier.id,
    name: supplier.name,
    displayName: supplier.displayName
    // ... other fields
  }
}
```

### **4. AccountStore Integration**

#### **Supplier ‚Üí AccountStore (Write bills):**

```typescript
// When PurchaseOrder is created, AUTOMATICALLY create PendingPayment
function createBillInAccount(order: PurchaseOrder): Promise<PendingPayment> {
  const billData: CreateBillInAccountStore = {
    counteragentId: order.supplierId,
    counteragentName: order.supplierName,
    amount: order.totalAmount,
    description: `–ó–∞–∫–∞–∑ ${order.orderNumber}`,
    category: 'supplier',
    invoiceNumber: order.orderNumber,
    purchaseOrderId: order.id, // metadata –¥–ª—è —Å–≤—è–∑–∏
    priority: 'medium', // default
    createdBy: {
      type: 'user',
      id: getCurrentUser().id,
      name: getCurrentUser().name
    }
  }

  return accountStore.createPayment(billData)
}
```

#### **AccountStore ‚Üí Supplier (Payment confirmation):**

```typescript
// When payment is processed, automatically update PurchaseOrder
function onPaymentProcessed(paymentId: string, transactionId: string) {
  // Find PurchaseOrder by billId
  const order = supplierStore.orders.find(o => o.billId === paymentId)
  if (order) {
    supplierStore.updateOrderPaymentStatus(order.id, 'paid')
  }
}
```

---

## üí∞ Payment Flow - –î–µ—Ç–∞–ª—å–Ω–æ

### **Step 3a: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–∞**

```typescript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PurchaseOrder –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
async function createPurchaseOrder(orderData: CreateOrderData) {
  // 1. –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
  const order = await supplierService.createOrder(orderData)

  // 2. –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò —Å–æ–∑–¥–∞–µ–º —Å—á–µ—Ç –≤ Account Store
  const billData: CreatePaymentDto = {
    counteragentId: order.supplierId,
    counteragentName: order.supplierName,
    amount: order.totalAmount,
    description: `–ó–∞–∫–∞–∑ ${order.orderNumber}`,
    category: 'supplier',
    invoiceNumber: order.orderNumber,
    priority: 'medium', // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    createdBy: currentUser
  }

  const bill = await accountStore.createPayment(billData)

  // 3. –°–≤—è–∑—ã–≤–∞–µ–º –∑–∞–∫–∞–∑ —Å–æ —Å—á–µ—Ç–æ–º
  order.billId = bill.id
  order.paymentStatus = 'pending'

  return order
}
```

### **Step 3b: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã (–æ—Ç–¥–µ–ª—å–Ω–æ)**

```typescript
// –ü–æ–∑–∂–µ, –≤ Account Store, finance manager:
async function processPayment(paymentId: string, accountId: string) {
  // 1. –ü—Ä–æ–≤–æ–¥–∏—Ç –ø–ª–∞—Ç–µ–∂
  await accountStore.processPayment({
    paymentId,
    accountId,
    performedBy: financeManager
  })

  // 2. –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
  const order = supplierStore.orders.find(o => o.billId === paymentId)
  if (order) {
    order.paymentStatus = 'paid'
  }
}
```

### **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É Store:**

```typescript
// –í supplierStore, —Å–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ accountStore
watch(
  () => accountStore.pendingPayments,
  payments => {
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π
    payments.forEach(payment => {
      const order = orders.find(o => o.billId === payment.id)
      if (order && payment.status === 'completed') {
        order.paymentStatus = 'paid'
      }
    })
  }
)
```

---

## üé® UI Structure

### **Navigation:**

```
üè† Dashboard
üì¶ Storage          ‚¨ÖÔ∏è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π (OrderAssistant —É–±–∏—Ä–∞–µ–º –æ—Ç—Å—é–¥–∞)
üõí Suppliers        ‚¨ÖÔ∏è –ù–û–í–´–ô –º–æ–¥—É–ª—å (—Å OrderAssistant –≤–Ω—É—Ç—Ä–∏)
üí∞ Accounts         ‚¨ÖÔ∏è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
üë• Staff
üìä Reports
‚öôÔ∏è Settings
```

### **SupplierView Structure:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üõí Suppliers & Orders                       ‚îÇ
‚îÇ ‚îú‚îÄ Tabs: [üìã Requests] [üì¶ Orders]         ‚îÇ
‚îÇ ‚îÇ         [üì• Receipts] [üìä Overview]       ‚îÇ
‚îÇ ‚îÇ                                          ‚îÇ
‚îÇ ‚îú‚îÄ Quick Actions:                          ‚îÇ
‚îÇ ‚îÇ  [üõí Order Assistant] [üìä Quick Stats]   ‚îÇ
‚îÇ ‚îÇ                                          ‚îÇ
‚îÇ ‚îî‚îÄ Tab Content (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **OrderAssistant (modal in Suppliers):**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üõí Order Assistant - Kitchen                ‚îÇ
‚îÇ ‚îú‚îÄ Department: [Kitchen ‚ñº] [Bar]           ‚îÇ
‚îÇ ‚îú‚îÄ Auto Suggestions:                       ‚îÇ
‚îÇ ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ  ‚îÇ ‚ö†Ô∏è URGENT: Out of Stock             ‚îÇ ‚îÇ
‚îÇ ‚îÇ  ‚îÇ ü•© Beef Steak: 0kg (min: 2kg)       ‚îÇ ‚îÇ
‚îÇ ‚îÇ  ‚îÇ Suggested: [5] kg @ 180k/kg         ‚îÇ ‚îÇ
‚îÇ ‚îÇ  ‚îÇ Last price: 3 days ago              ‚îÇ ‚îÇ
‚îÇ ‚îÇ  ‚îÇ [‚úì Add to request]                  ‚îÇ ‚îÇ
‚îÇ ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ ‚îÇ                                          ‚îÇ
‚îÇ ‚îú‚îÄ Manual Add: [+ Add item ‚ñº]             ‚îÇ
‚îÇ ‚îú‚îÄ Request Summary:                        ‚îÇ
‚îÇ ‚îÇ  ‚Ä¢ 3 items, est. 2.4M IDR               ‚îÇ
‚îÇ ‚îÇ                                          ‚îÇ
‚îÇ ‚îî‚îÄ [Cancel] [Create Request]               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **Supplier Assignment UI:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üì¶ Create Orders from Requests              ‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ ‚îå‚îÄ Filters ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ ‚îÇ Category: [All ‚ñº] [Meat] [Vegetables]    ‚îÇ‚îÇ
‚îÇ ‚îÇ [‚úì Select All] [Clear Selection]         ‚îÇ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ ‚îå‚îÄ –ù–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ (12 —Ç–æ–≤–∞—Ä–æ–≤) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ ‚îÇ ‚òê ü•© Beef (5kg) @ 180k                  ‚îÇ‚îÇ
‚îÇ ‚îÇ ‚òê ü•õ Milk (8L) @ 15k                    ‚îÇ‚îÇ
‚îÇ ‚îÇ [Assign to Supplier ‚ñº]                  ‚îÇ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ                                             ‚îÇ
‚îÇ ‚îå‚îÄ Premium Meat Co (3 —Ç–æ–≤–∞—Ä–∞) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ ‚îÇ ‚Ä¢ ü•© Beef Steak (2kg) @ 180k            ‚îÇ‚îÇ
‚îÇ ‚îÇ ‚Ä¢ üêî Chicken (5kg) @ 120k               ‚îÇ‚îÇ
‚îÇ ‚îÇ Total: ~900k IDR                        ‚îÇ‚îÇ
‚îÇ ‚îÇ [Create Order] [Clear]                  ‚îÇ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìÖ Implementation Roadmap

### **Week 1: Core Foundation**

- [x] ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —É–ø—Ä–æ—â–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤
- [ ] üî≤ `supplierService.ts` —Å –±–∞–∑–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π
- [ ] üî≤ Mock –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] üî≤ `supplierStore.ts` —Å –±–∞–∑–æ–≤—ã–º–∏ actions

### **Week 2: OrderAssistant & Requests**

- [ ] üî≤ `OrderAssistantDialog.vue` —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏
- [ ] üî≤ ProcurementRequest —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- [ ] üî≤ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å StorageStore –¥–ª—è –æ—Å—Ç–∞—Ç–∫–æ–≤

### **Week 3: Supplier Assignment & Orders**

- [ ] üî≤ UI –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º
- [ ] üî≤ PurchaseOrder —Å–æ–∑–¥–∞–Ω–∏–µ —Å –∞–≤—Ç–æ—Ü–µ–Ω–∞–º–∏
- [ ] üî≤ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CounterAgentsStore

### **Week 4: Receipt & Integration**

- [ ] üî≤ Receipt –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –ø—Ä–∏–µ–º–∫–∏
- [ ] üî≤ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å StorageStore (—Å–æ–∑–¥–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π)
- [ ] üî≤ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AccountStore (—Å–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–æ–≤)

### **Week 5: Polish & Testing**

- [ ] üî≤ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ workflow
- [ ] üî≤ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] üî≤ UX —É–ª—É—á—à–µ–Ω–∏—è

---

## üéØ Critical Data Links

| From Store             | To Store         | Field Mapping                                                  | Purpose                  |
| ---------------------- | ---------------- | -------------------------------------------------------------- | ------------------------ |
| **ProductsStore**      | **Supplier**     | `Product.id` ‚Üí `RequestItem.itemId`                            | Product catalog          |
| **StorageStore**       | **Supplier**     | `StorageBalance.latestCost` ‚Üí `OrderSuggestion.estimatedPrice` | Price history            |
| **Supplier**           | **StorageStore** | `Receipt` ‚Üí `CreateReceiptData`                                | Create receipt operation |
| **Supplier**           | **AccountStore** | `PurchaseOrder` ‚Üí `CreatePaymentDto`                           | Create bills             |
| **AccountStore**       | **Supplier**     | `PendingPayment.id` ‚Üí `PurchaseOrder.billId`                   | Link payments            |
| **CounterAgentsStore** | **Supplier**     | `Counteragent.id` ‚Üí `PurchaseOrder.supplierId`                 | Supplier info            |

---

## üöÄ Success Criteria

### **Functional Requirements:**

- ‚úÖ OrderAssistant —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Å—Ç–∞—Ç–∫–æ–≤
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º
- ‚úÖ –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ü–µ–Ω –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ Storage –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–æ–≤ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∏–µ–º–∫–æ–π –Ω–∞ —Å–∫–ª–∞–¥

### **Technical Requirements:**

- ‚úÖ –ß–µ—Ç–∫–∏–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É Store –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ FIFO —É—á–µ—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Storage –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π UI

**–≠—Ç–æ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ workflow –∑–∞–∫–∞–∑–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ Store –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π! üöÄ**
