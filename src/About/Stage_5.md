ğŸ“‹ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
Ğ˜Ğ·ÑƒÑ‡Ğ¸Ğ» Ğ²Ğ°ÑˆĞµ Ğ¢Ğ— Ğ¸ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ ĞºĞ¾Ğ´Ğ¾Ğ²ÑƒÑ Ğ±Ğ°Ğ·Ñƒ. Ğ’ÑĞµ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ÑƒÑ‡Ñ‚ĞµĞ½Ñ‹ Ğ¸ Ğ¿Ğ¾Ğ½ÑÑ‚Ğ½Ñ‹. Ğ’Ğ¾Ñ‚ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ñ‹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ñ ÑƒÑ‡ĞµĞ»:
âœ… Ğ£Ñ‡Ñ‚ĞµĞ½Ğ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:

ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ - ÑƒĞ¿Ñ€Ğ¾ÑÑ‚Ğ¸Ğ» Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñƒ, ÑƒĞ±Ñ€Ğ°Ğ» ÑĞ»Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ½Ğ° Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ ÑÑ‚Ğ°Ğ¿Ğµ
Ğ”Ğ²Ğ° ÑĞºĞ»Ğ°Ğ´Ğ° (Kitchen/Bar) - Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ´ĞµĞ¿Ğ°Ñ€Ñ‚Ğ°Ğ¼ĞµĞ½Ñ‚Ñ‹ Ñ Ğ½ĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ñ‹Ğ¼ ÑƒÑ‡ĞµÑ‚Ğ¾Ğ¼
Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ - ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¹ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³ Ğ´Ğ»Ñ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²/Ğ¿Ğ¾Ğ»ÑƒÑ„Ğ°Ğ±Ñ€Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ²/Ğ±Ğ»ÑĞ´
Ğ£Ğ´Ğ¾Ğ±Ğ½Ğ°Ñ Ğ¸Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ - Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸ Ğ´Ğ»Ñ Products Ğ¸ Preparations Ñ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¼Ğ¸ ÑĞ¿Ğ¸ÑĞºĞ°Ğ¼Ğ¸
Ğ£Ñ‡ĞµÑ‚ Ğ¿Ğ¾Ğ»ÑƒÑ„Ğ°Ğ±Ñ€Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ² - Ğ¿Ğ¾Ğ»Ğ½Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° preparations Ğ½Ğ°Ñ€Ğ°Ğ²Ğ½Ğµ Ñ products
FIFO Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ - ÑÑ‚Ñ€Ğ¾Ğ³Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ "Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸ÑˆĞµĞ» - Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ÑƒÑˆĞµĞ»"
Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸ĞºĞ° Ñ†ĞµĞ½ - ÑÑ€ĞµĞ´Ğ½ÑÑ Ñ†ĞµĞ½Ğ° Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¾Ğ² + Ñ‚Ñ€ĞµĞ½Ğ´Ñ‹, FIFO Ğ´Ğ»Ñ ÑĞµĞ±ĞµÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
ĞŸÑ€Ğ¸Ñ…Ğ¾Ğ´Ñ‹ Ñ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ†Ğ¸ÑĞ¼Ğ¸ - Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ´Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ SupplierStore
Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… mock Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… - Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Product Ğ¸ Recipe stores

ğŸ—ï¸ Ğ­Ñ‚Ğ°Ğ¿Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:
Phase 1: StorageStore (Week 1)

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ¾Ğ² Ğ¸ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ¾Ğ² Ğ´Ğ»Ñ ÑĞºĞ»Ğ°Ğ´Ğ°
Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ FIFO Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ Ñ batch tracking
Mock Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… products/preparations
Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ StorageService Ğ¸ StorageStore

Phase 2: StorageStore and PreparationStore UI (Week 2)

StorageView Ñ Ñ‚Ğ°Ğ±Ğ°Ğ¼Ğ¸ Kitchen/Bar
Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ¿Ğ¾ÑÑ‚ÑƒĞ¿Ğ»ĞµĞ½Ğ¸Ğ¹/ĞºĞ¾Ñ€Ñ€ĞµĞºÑ†Ğ¸Ğ¹
Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Product/Recipe stores

Phase 3: SupplierStore (Week 3)

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ¾Ğ² Ğ´Ğ»Ñ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ñ‰Ğ¸ĞºĞ¾Ğ² Ğ¸ Ğ·Ğ°ĞºÑƒĞ¿Ğ¾Ğº
Workflow ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°Ğ¼Ğ¸
Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ StorageStore Ğ´Ğ»Ñ Ğ¿Ğ¾ÑÑ‚ÑƒĞ¿Ğ»ĞµĞ½Ğ¸Ğ¹
UI Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ñ‰Ğ¸ĞºĞ°Ğ¼Ğ¸

Phase 4: Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ AccountStore (Week 4)

Ğ¡Ğ²ÑĞ·ÑŒ Ñ Ñ„Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ğ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ¾Ğ¹
ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ€Ğ°ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ñ‰Ğ¸ĞºĞ°Ğ¼
ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹

Phase 5: Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ Ğ¸ Ğ¿Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° (Week 5)

ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ğ°Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ¸ Ğ¾Ñ‚Ñ‡ĞµÑ‚Ñ‹
Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Menu Store Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ
ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ´Ğ¾Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° UX

ğŸ¯ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ğ¾Ğ¹ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸:

MultiConsumptionDialog - Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ·Ğ° Ñ€Ğ°Ğ· Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹
Ğ Ğ°Ğ·Ğ´ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ - Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ğ°Ğ±Ñ‹ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ² Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ„Ğ°Ğ±Ñ€Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ²
ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ñ†ĞµĞ½ - Ñ‚Ñ€ĞµĞ½Ğ´Ñ‹, ÑÑ€ĞµĞ´Ğ½Ğ¸Ğµ Ñ†ĞµĞ½Ñ‹, FIFO Ñ€Ğ°ÑÑ‡ĞµÑ‚Ñ‹
Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ - Ğ¿Ğ¾Ğ¿ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğµ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ñ‹ Ğ² Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ¼ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğµ
Department-based - Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğµ Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Kitchen Ğ¸ Bar
Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ mock Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… products Ğ¸ recipes

# ğŸ“¦ Storage & Supplies Management System - Updated Technical Specification

## ğŸ¯ Key Changes Based on Requirements

### Simplified Initial Implementation:

1. **Two departments**: Kitchen and Bar (separate stock management)
2. **Quick consumption workflow**: Multi-item consumption in single dialog
3. **Inventory management**: Separate tabs for Products and Preparations with full stock lists
4. **FIFO cost calculation**: First In, First Out principle
5. **Price analytics**: Average costs and cost trends tracking
6. **Corrections via Storage**: Basic receiving with correction flag
7. **Test with existing mock data**: Use products and preparations from existing stores

---

## ğŸ”„ Updated Module Relationships

### **Storage Store â†” Existing Modules:**

#### **â†’ Product Store (Read Only)**

```typescript
// Use existing products from mock data
interface Product {
  id: string
  name: string
  category: string
  unit: string // 'kg', 'liter', 'piece', etc.
  minStock?: number
  shelfLife?: number
}
```

#### **â†’ Recipe Store (Read Only)**

```typescript
// Use existing preparations from mock data
interface Preparation {
  id: string
  name: string
  type: 'preparation'
  outputQuantity: number
  outputUnit: string
}
```

---

## ğŸ“Š Storage Store Specification

### **Core Entities:**

#### **StorageBatch** - Individual stock lots with FIFO tracking

```typescript
interface StorageBatch extends BaseEntity {
  // Identification
  batchNumber: string // "B-BEEF-001-20250205"
  itemId: string // Product or Preparation ID
  itemType: 'product' | 'preparation'
  department: 'kitchen' | 'bar'

  // Quantity tracking
  initialQuantity: number // Original received quantity
  currentQuantity: number // Remaining quantity
  unit: string // kg, liter, piece, etc.

  // Cost tracking (FIFO)
  costPerUnit: number // Cost per unit for THIS batch
  totalValue: number // currentQuantity Ã— costPerUnit

  // Dates and expiry
  receiptDate: string // When batch was received
  expiryDate?: string // When batch expires

  // Source tracking
  sourceType: 'purchase' | 'production' | 'correction' | 'opening_balance'
  notes?: string

  // Status
  status: 'active' | 'expired' | 'consumed'
  isActive: boolean
}
```

#### **StorageOperation** - All inventory movements

```typescript
interface StorageOperation extends BaseEntity {
  // Operation details
  operationType: 'receipt' | 'consumption' | 'inventory' | 'correction'
  documentNumber: string // "REC-001", "CON-001", "INV-001"
  operationDate: string
  department: 'kitchen' | 'bar'

  // Responsible person
  responsiblePerson: string // Who performed the operation

  // Items involved
  items: StorageOperationItem[]

  // Financial impact
  totalValue?: number // Total cost impact of operation

  // Consumption tracking with quick selection
  consumptionDetails?: {
    reason: 'recipe' | 'menu_item' | 'waste' | 'expired' | 'other'
    relatedId?: string // Recipe ID, Menu Item ID, etc.
    relatedName?: string // Human readable name
    portionCount?: number // How many portions made
  }

  // Status and workflow
  status: 'draft' | 'confirmed'
  notes?: string
}

interface StorageOperationItem {
  id: string
  itemId: string // Product or Preparation ID
  itemType: 'product' | 'preparation'
  itemName: string // Cached name for display

  // Quantity
  quantity: number
  unit: string

  // FIFO allocation (for consumption)
  batchAllocations?: BatchAllocation[]

  // Cost tracking
  totalCost?: number // Calculated total cost
  averageCostPerUnit?: number // Weighted average cost

  // Additional details
  notes?: string
  expiryDate?: string // For receipts
}

interface BatchAllocation {
  batchId: string // Which batch to consume from
  batchNumber: string // Human readable batch number
  quantity: number // How much from this batch
  costPerUnit: number // Cost per unit from this batch
  batchDate: string // Receipt date of batch (for FIFO verification)
}
```

#### **StorageBalance** - Current stock summary with analytics

```typescript
interface StorageBalance {
  // Item identification
  itemId: string
  itemType: 'product' | 'preparation'
  itemName: string // Cached name
  department: 'kitchen' | 'bar'

  // Current stock
  totalQuantity: number // Sum of all active batches
  unit: string

  // Financial summary with price analytics
  totalValue: number // Total value of all batches
  averageCost: number // Weighted average cost per unit
  latestCost: number // Cost of most recent batch
  costTrend: 'up' | 'down' | 'stable' // Price trend indicator

  // FIFO batch details
  batches: StorageBatch[] // All active batches (sorted FIFO - oldest first)
  oldestBatchDate: string // Date of oldest batch
  newestBatchDate: string // Date of newest batch

  // Alerts and warnings
  hasExpired: boolean // Has any expired batches
  hasNearExpiry: boolean // Has batches expiring within 3 days
  belowMinStock: boolean // Below minimum stock level

  // Usage analytics
  lastConsumptionDate?: string // When last consumed
  averageDailyConsumption?: number // Moving average consumption
  daysOfStockRemaining?: number // Estimated days until stockout

  // Cache timestamps
  lastCalculated: string // When this balance was calculated
}
```

#### **InventoryDocument** - Periodic stock takes (Products & Preparations separate)

```typescript
interface InventoryDocument extends BaseEntity {
  // Document details
  documentNumber: string // "INV-KITCHEN-PROD-001"
  inventoryDate: string
  department: 'kitchen' | 'bar'
  itemType: 'product' | 'preparation' // Separate inventories

  // Responsible person
  responsiblePerson: string

  // Inventory results
  items: InventoryItem[]

  // Summary
  totalItems: number // Number of items counted
  totalDiscrepancies: number // Number of items with differences
  totalValueDifference: number // Total financial impact

  // Status
  status: 'draft' | 'confirmed'
  notes?: string
}

interface InventoryItem {
  id: string
  itemId: string
  itemType: 'product' | 'preparation'
  itemName: string // Cached name

  // Quantities
  systemQuantity: number // Quantity per system
  actualQuantity: number // Actual counted quantity
  difference: number // actualQuantity - systemQuantity

  // Financial impact
  unit: string
  averageCost: number // Current average cost per unit
  valueDifference: number // difference Ã— averageCost

  // Details
  notes?: string // Reasons for discrepancy
  countedBy?: string // Who counted this item
}
```

### **Store State:**

```typescript
interface StorageState {
  // Core data
  batches: StorageBatch[]
  operations: StorageOperation[]
  balances: StorageBalance[]
  inventories: InventoryDocument[]

  // UI state
  loading: {
    balances: boolean
    operations: boolean
    inventory: boolean
    consumption: boolean
  }
  error: string | null

  // Quick access data for consumption dialog
  quickItems: {
    products: Product[] // Popular products
    preparations: Preparation[] // Popular preparations
    menuItems: MenuItem[] // For consumption tracking
  }

  // Filters and search
  filters: {
    department: 'kitchen' | 'bar' | 'all'
    itemType: 'product' | 'preparation' | 'all'
    showExpired: boolean
    showBelowMinStock: boolean
    showNearExpiry: boolean
    search: string
    dateFrom?: string
    dateTo?: string
  }

  // Settings
  settings: {
    expiryWarningDays: number // Days before expiry to show warning (default: 3)
    lowStockMultiplier: number // Multiplier of minStock for low stock warning (default: 1.2)
    autoCalculateBalance: boolean // Auto-recalculate balances on operations (default: true)
  }
}
```

### **Key Methods:**

#### **FIFO Operations:**

```typescript
// FIFO consumption with automatic batch allocation
async createConsumption(data: CreateConsumptionData): Promise<StorageOperation>

// FIFO cost calculation
calculateFifoAllocation(
  itemId: string,
  itemType: 'product' | 'preparation',
  department: 'kitchen' | 'bar',
  quantity: number
): BatchAllocation[]

// Get consumption cost based on FIFO
calculateConsumptionCost(
  itemId: string,
  itemType: 'product' | 'preparation',
  department: 'kitchen' | 'bar',
  quantity: number
): number
```

#### **Quick Operations:**

```typescript
// Get popular items for quick selection
getQuickProducts(department: 'kitchen' | 'bar'): Product[]
getQuickPreparations(department: 'kitchen' | 'bar'): Preparation[]
getQuickMenuItems(): MenuItem[]

// Multi-item consumption
async createMultiItemConsumption(
  items: ConsumptionItem[],
  department: 'kitchen' | 'bar',
  responsiblePerson: string,
  consumptionDetails?: ConsumptionDetails
): Promise<StorageOperation>
```

#### **Inventory Management:**

```typescript
// Full inventory with all items
async startInventory(
  department: 'kitchen' | 'bar',
  itemType: 'product' | 'preparation'
): Promise<InventoryDocument>

// Update inventory counts
async updateInventoryItem(
  inventoryId: string,
  itemId: string,
  actualQuantity: number,
  notes?: string
): Promise<void>

// Finalize inventory and create corrections
async finalizeInventory(inventoryId: string): Promise<StorageOperation[]>
```

#### **Analytics and Price Tracking:**

```typescript
// Price trend analysis
getPriceTrends(itemId: string, months: number): PriceTrend[]
getAverageCosts(department: 'kitchen' | 'bar'): ItemCostSummary[]

// Consumption analytics
getConsumptionHistory(itemId: string, days: number): ConsumptionHistory[]
getTopConsumedItems(department: 'kitchen' | 'bar', limit: number): ItemUsageSummary[]

// Alerts
getExpiringItems(days: number): StorageBalance[]
getLowStockItems(): StorageBalance[]
```

---

## ğŸ¨ UI Components Architecture

### **StorageView.vue** - Main dashboard with department tabs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¦ Storage Management                       â”‚
â”‚ â”œâ”€ [Kitchen] [Bar] (department tabs)        â”‚
â”‚ â”œâ”€ Quick Actions: [â– Multi Consumption]    â”‚
â”‚ â”‚                  [ğŸ“‹ Inventory Products]  â”‚
â”‚ â”‚                  [ğŸ“‹ Inventory Prep.]     â”‚
â”‚ â”‚                  [â• Receipt/Correction]  â”‚
â”‚ â”œâ”€ Alerts: [âš ï¸ Expiring (3)] [ğŸ“‰ Low (5)]  â”‚
â”‚ â”œâ”€ Stock Overview:                          â”‚
â”‚ â”‚  â”Œâ”€ [Products] [Preparations] tabs â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚  â”‚ Item | Stock | Avg Cost | Trend | Actionsâ”‚â”‚
â”‚ â”‚  â”‚ ğŸ¥© Beef | 2.5kg | 180k | ğŸ“ˆ+5% | [â–][ğŸ“¦]â”‚â”‚
â”‚ â”‚  â”‚ ğŸ¥” Potato | 15kg | 8k | ğŸ“‰-2% | [â–][ğŸ“¦]â”‚â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚ â””â”€ Recent Operations: [View All]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **MultiConsumptionDialog.vue** - Quick multi-item consumption

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Multi-Item Consumption - Kitchen            â”‚
â”‚ â”œâ”€ Responsible: [Chef Maria â–¼]             â”‚
â”‚ â”œâ”€ Usage Type: [Recipe â–¼] â†’ Beef Rendang   â”‚
â”‚ â”œâ”€ Quick Add Popular Items:                â”‚
â”‚ â”‚  [ğŸ¥© Beef] [ğŸ¥” Potato] [ğŸ§„ Garlic] [Moreâ–¼]â”‚
â”‚ â”œâ”€ Items to Consume:                       â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  â”‚ ğŸ¥© Beef Steak                       â”‚ â”‚
â”‚ â”‚  â”‚ Available: 2.5kg                    â”‚ â”‚
â”‚ â”‚  â”‚ Consume: [1.5] kg                   â”‚ â”‚
â”‚ â”‚  â”‚ FIFO: 1.5kg from B-BEEF-001 @180k  â”‚ â”‚
â”‚ â”‚  â”‚ Cost: 270,000 IDR          [Remove] â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  â”‚ ğŸ¥” Potato                           â”‚ â”‚
â”‚ â”‚  â”‚ Available: 15kg                     â”‚ â”‚
â”‚ â”‚  â”‚ Consume: [2] kg                     â”‚ â”‚
â”‚ â”‚  â”‚ Cost: 16,000 IDR           [Remove] â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚  [+ Add Item] [ğŸ“‹ Add from Recipe]      â”‚
â”‚ â”œâ”€ Total Cost: 286,000 IDR                 â”‚
â”‚ â””â”€ [Cancel] [Confirm Consumption]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **InventoryDialog.vue** - Full inventory management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Inventory - Kitchen Products                â”‚
â”‚ â”œâ”€ Date: [05.02.25] Person: [Manager â–¼]    â”‚
â”‚ â”œâ”€ Filter: [ğŸ” Search] [âš ï¸ Discrepancies]   â”‚
â”‚ â”œâ”€ Progress: 25/30 items counted            â”‚
â”‚ â”œâ”€ Items List:                             â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  â”‚ ğŸ¥© Beef Steak                       â”‚ â”‚
â”‚ â”‚  â”‚ System: 2.5kg                       â”‚ â”‚
â”‚ â”‚  â”‚ Actual: [2.3] kg  âš ï¸ -0.2kg        â”‚ â”‚
â”‚ â”‚  â”‚ Notes: [Normal shrinkage...]        â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  â”‚ ğŸ¥” Potato                           â”‚ â”‚
â”‚ â”‚  â”‚ System: 15kg                        â”‚ â”‚
â”‚ â”‚  â”‚ Actual: [15] kg  âœ… Match           â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”œâ”€ Summary: Discrepancies: 3 Value: -45k   â”‚
â”‚ â””â”€ [Save Draft] [Finalize Inventory]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Implementation Phases

### **Phase 1: Storage Store Foundation (Week 1)**

- [ ] Create storage types based on existing product/preparation interfaces
- [ ] Implement FIFO calculation logic with batch tracking
- [ ] Create mock storage data using existing products/preparations
- [ ] Build StorageService with CRUD operations
- [ ] Set up StorageStore with state management

**Mock Data Integration:**

```typescript
// Use existing mock products and preparations
const mockProducts = [
  { id: 'beef-steak', name: 'Beef Steak', category: 'meat', unit: 'kg' },
  { id: 'potato', name: 'Potato', category: 'vegetable', unit: 'kg' }
  // ... existing products
]

const mockPreparations = [
  { id: 'beef-rendang', name: 'Beef Rendang', outputQuantity: 10, outputUnit: 'portion' }
  // ... existing preparations
]

// Create initial batches for testing
const mockBatches = [
  {
    itemId: 'beef-steak',
    itemType: 'product',
    department: 'kitchen',
    currentQuantity: 2.5,
    costPerUnit: 180000,
    receiptDate: '2025-02-01',
    sourceType: 'opening_balance'
  }
]
```

### **Phase 2: Storage UI (Week 2)**

- [ ] StorageView with Kitchen/Bar tabs and stock overview
- [ ] MultiConsumptionDialog with quick item selection
- [ ] Basic receiving/correction functionality
- [ ] Integration with existing Product/Recipe stores
- [ ] FIFO cost display and price trend indicators

### **Phase 3: Inventory Management (Week 3)**

- [ ] InventoryDialog with full item lists (Products & Preparations separate)
- [ ] Inventory workflow: count â†’ discrepancies â†’ finalize
- [ ] Automatic correction generation from inventory
- [ ] Inventory history and reporting

### **Phase 4: Analytics & Polish (Week 4)**

- [ ] Price trend analysis and cost tracking
- [ ] Consumption analytics and reporting
- [ ] Advanced alerts and notifications
- [ ] Performance optimization and caching
- [ ] User testing and bug fixes

### **Phase 5: Future Expansion (Week 5+)**

- [ ] Integration with Menu Store for automatic consumption
- [ ] Advanced recipe-based consumption tracking
- [ ] Supplier management integration (SupplierStore)
- [ ] Account Store integration for financial tracking

---

## ğŸ¯ Success Criteria

### **Technical Requirements:**

- âœ… FIFO cost calculation with 100% accuracy
- âœ… Real-time stock balance updates across departments
- âœ… Quick multi-item consumption workflow
- âœ… Separate inventory management for Products and Preparations
- âœ… Price trend tracking and average cost calculation

### **Business Requirements:**

- âœ… Support for Kitchen and Bar departments
- âœ… Easy consumption tracking with recipe/menu integration
- âœ… Comprehensive inventory management
- âœ… Price analytics for menu cost calculation
- âœ… FIFO principle for accurate cost tracking

### **User Experience Requirements:**

- âœ… Quick access to popular items in consumption
- âœ… Single dialog for multi-item operations
- âœ… Clear price trends and cost information
- âœ… Intuitive inventory counting interface
- âœ… Department-based stock management

---

This specification provides a simplified yet comprehensive approach that addresses all your requirements while maintaining integration with existing systems and preparing for future expansion to supplier management and financial integration.
